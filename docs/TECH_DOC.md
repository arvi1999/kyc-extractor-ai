# Technical Documentation - Company Name Cleaning (CC)

## 1. System Architecture
The system will be designed as a modular microservice or a standalone API service that can be integrated into the existing recruitment platform.

### High-Level Components
1.  **API Gateway / Controller**: Handles incoming requests (file uploads/URLs), validation, and response formatting.
2.  **Document Processor**:
    -   **Ingestion**: Downloads file or reads stream.
    -   **Preprocessing**: Image conversion (PDF to Img), resizing, noise reduction.
3.  **Extraction Engine**:
    -   **OCR Layer**: Converts image to raw text.
    -   **Parsing/Intelligence Layer**: Extracts structured fields (Name, Address, ID) from raw text or visual layout.
4.  **Post-Processing**:
    -   **Validation**: Regex checks (PAN, GSTIN).
    -   **Standardization**: Date formatting, address normalization.

## 2. System Workflows

### 2.1 Synchronous Extraction Flow (Selected for POC)
1.  **User/System** sends `POST /extract` with file/URL.
2.  **API** validates input.
3.  **Processor** converts PDF to Image (if needed).
4.  **Extraction Engine** (Gemini Flash) processes the image.
5.  **API** returns JSON response immediately.

### 2.2 Asynchronous Extraction Flow (Future Production / High Volume)
*Note: Described for future reference, not implemented in POC.*
1.  **User/System** sends `POST /extract` -> receives `job_id`.
2.  **API** pushes job to **Message Queue**.
3.  **Worker** picks up job, processes file.
4.  **Worker** saves result to **DB / Cache**.
5.  **User/System** polls `GET /status/{job_id}`.

## 3. Tech Stack Options
We need to decide on the core extraction technology.

### Option A: Pure Open Source (Local/Self-Hosted)
*   **Language**: Python 3.10+
*   **OCR**: `PaddleOCR` or `Tesseract` (Good for raw text, harder for layout-specific extraction without training).
*   **Parsing**: Regex + Heuristics (Spacy/NLP).
*   **Pros**: Free, full control, data stays local.
*   **Cons**: High development effort for high accuracy across 6 different complex layouts. Maintenance heavy.

### Option B: Vision LLM / API (Recommended for Accuracy)
*   **Language**: Python 3.10+
*   **Core Engine**: `Gemini Flash 1.5` (or similar Vision API).
*   **Why**: Vision LLMs are excellent at "zero-shot" extraction from varied layouts (like identifying "Legal Name" vs "Trade Name" on a cluttered GST cert).
*   **Pros**: Extremely high accuracy, handles all 6 types out of the box, easy to maintain.
*   **Cons**: API Cost (though Flash is very cheap), Data privacy (requires sending doc to API - *Note: Enterprise APIs usually have privacy guarantees*).

### Option C: Hybrid
*   Use Open Source OCR for simple docs.
*   Fallback to LLM for complex/low-confidence docs.

## 4. Proposed Stack (for POC)
*   **Backend Framework**: `FastAPI` (High performance, auto-docs).
*   **Task Queue**: *None for POC* (Direct synchronous processing).
*   **Extraction**: **Gemini Flash 1.5** (Vision LLM).
*   **Deployment**: Docker.

## 5. Data Model (JSON Output)
```json
{
  "status": "success",
  "document_type": "GST_CERTIFICATE",
  "data": {
    "company_name": "ABC TRADING PVT LTD",
    "trade_name": "ABC TRADERS",
    "identification_number": "27ABCDE1234F1Z5",
    "address": {
        "full_address": "123, Market Road, Mumbai, Maharashtra 400001",
        "address_line_1": "123, Market Road",
        "locality": "Andheri West",
        "city": "Mumbai",
        "state": "Maharashtra",
        "pincode": "400001"
    },
    "issue_date": "2023-01-15",
    "approver_name": "DS GST OFFICER"
  },
  "confidence": 0.95,
  "metadata": {
    "processing_time_ms": 1200
  }
}
```
**Note on Confidence Score:**
Since we are using an LLM, "confidence" will be a self-assessed score generated by the model. We will prompt the model to rate the legibility and its certainty of the extracted fields on a scale of 0.0 to 1.0.

## 6. Next Steps
1.  Approve Tech Stack (specifically the Extraction Engine choice).
2.  Setup Project Structure.
3.  Implement POC with one document type first.
